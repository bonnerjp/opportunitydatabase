class Opportunity < ActiveRecord::Base
    belongs_to :user
    default_scope -> { order('created_at DESC') }

    before_save {
        downcase(:track=, self.track)
        downcase(:location=, self.location)
        downcase(:position=, self.position)
        downcase(:company=, self.company)
        downcase(:link=, self.link)
        self.salary_low ? self.salary_low : self.salary_low = 0
        self.salary_high ? self.salary_high : self.salary_high = 0
        self.user_id ? self.user_id : self.user_id = 1
    }

    def downcase(setter, arg)
        dc = arg.downcase
        dc = !dc.nil? ? dc : ''
        self.send(setter, dc)
    end


    validates :user_id, presence: :true
    validates :position, presence: :true
    validates :company, presence: :true
    validates :location, presence: :true
    validates :track, presence: :true
    # validates :salary, numericality: true

    scope :track, lambda { |track| where(track: track.downcase) }
    scope :city, lambda { |city| where(location: city.downcase) }
    scope :salary, lambda { |salary| where("salary_low > ?", salary*1000) }
end
#--
# generated by 'annotated-rails' gem, please do not remove this line and content below, instead use `bundle exec annotate-rails -d` command
#++
# Table name: opportunities
#
# * id          :integer         not null
#   position    :string(255)
#   company     :string(255)
#   location    :string(255)
#   contact     :string(255)
#   link        :text(255)
#   created_at  :datetime
#   updated_at  :datetime
#   track       :string(255)
#   user_id     :integer
#   notes       :text(255)
#   salary_low  :integer
#   salary_high :integer
#--
# generated by 'annotated-rails' gem, please do not remove this line and content above, instead use `bundle exec annotate-rails -d` command
#++
